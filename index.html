<!doctype html>
<html>
<head>
  <title>Ship Controller</title>

  <script
  src="http://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.4/lodash.min.js"></script>
</head>
<body>

<script>
  var screw_state = false;

  $(function(){
    $("#ip").val("192.168.1.252");
  });

  var get_ip = function() {
    return $("#ip").val();
  }

  var toggle_screw = function() {
    if(screw_state) {
      screw_off();
      screw_state = false;
    } else {
      screw_on();
      screw_state = true;
    }
  }

  var set_yaw = function() {
    var val = $("#yaw").val();
    yaw(val);
  }

  var throttled_set_yaw = _.throttle(set_yaw, 500);

  var screw_on = function() {
    $.ajax("http://" + get_ip() + "/screw/on", {
        type: 'GET',
        dataType: 'html',
        crossDomain: true,
        success: function(data) {
            // $.colorbox({html:data.responseText, width:"80%", height:"80%"});
            console.log("complete");
        }, error:function(e) {
            console.log(e);
        }
    });
  }

  var screw_off = function() {
    $.ajax("http://" + get_ip() + "/screw/off", {
        type: 'GET',
        dataType: 'html',
        crossDomain: true,
        success: function(data) {
            // $.colorbox({html:data.responseText, width:"80%", height:"80%"});
            console.log("complete");
        }, error:function(e) {
            console.log(e);
        }
    });
  }

  var yaw = function(val) {
    $.ajax("http://" + get_ip() + "/rudder/yaw?value=" + val, {
        type: 'GET',
        dataType: 'html',
        crossDomain: true,
        success: function(data) {
            // $.colorbox({html:data.responseText, width:"80%", height:"80%"});
            console.log("complete");
        }, error:function(e) {
            console.log(e);
        }
    });
  }
</script>

<h1>ESP8266 WiFi Ship Controller</h1>
<div>
  <p>ESP8266 IP Address
    <input id="ip" type="text">
  </p>
</div>

<div>
  <button id="screw" type="button" onclick="toggle_screw()">Toggle Screw</button>
</div>

<div>
  <input id="yaw" type="range" min="0" max="1023" oninput="throttled_set_yaw()">
</div>

</body>
</html>
